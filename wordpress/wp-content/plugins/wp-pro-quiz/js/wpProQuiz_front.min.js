!function(i,e){i=i||"wpProQuizReady",e=e||window;var t=[],o=!1,n=!1;function r(){if(!o){o=!0;for(var i=0;i<t.length;i++)t[i].fn.call(window,t[i].ctx);t=[]}}function s(){"complete"===document.readyState&&r()}e[i]=function(i,e){o?setTimeout(function(){i(e)},1):(t.push({fn:i,ctx:e}),"complete"===document.readyState?setTimeout(r,1):n||(document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):(document.attachEvent("onreadystatechange",s),window.attachEvent("onload",r)),n=!0))}}("wpProQuizReady",window),wpProQuizReady(function(){for(var i=window.wpProQuizInitList||[],e=0;e<i.length;e++)jQuery(i[e].id).wpProQuizFront(i[e].init)}),function(i){i.wpProQuizFront=function(e,t){var o,n,r,s=i(e),a=t,u=this,d=new Object,c=new Object,p=0,l=null,h=[],f="",w=!1,m=1,Q={randomAnswer:0,randomQuestion:0,disabledAnswerMark:0,checkBeforeStart:0,preview:0,cors:0,isAddAutomatic:0,quizSummeryHide:0,skipButton:0,reviewQustion:0,autoStart:0,forcingQuestionSolve:0,hideQuestionPositionOverview:0,formActivated:0,maxShowQuestion:0,sortCategories:0},z={isQuizStart:0,isLocked:0,loadLock:0,isPrerequisite:0,isUserStartLocked:0},v='input[name="check"]',_='input[name="next"]',P=".wpProQuiz_questionList",g='input[name="skip"]',q='input[name="wpProQuiz_pageLeft"]',x='input[name="wpProQuiz_pageRight"]',k={back:s.find('input[name="back"]'),next:s.find(_),quiz:s.find(".wpProQuiz_quiz"),questionList:s.find(".wpProQuiz_list"),results:s.find(".wpProQuiz_results"),quizStartPage:s.find(".wpProQuiz_text"),timelimit:s.find(".wpProQuiz_time_limit"),toplistShowInButton:s.find(".wpProQuiz_toplistShowInButton"),listItems:i()},S={token:"",isUser:0},b=0,y=1,I=(o=a.timelimit,n=0,r={stop:function(){o&&(window.clearInterval(n),k.timelimit.hide())},start:function(){if(o){var i=1e3*o,e=k.timelimit.find("span").text(u.methode.parseTime(o)),t=k.timelimit.find(".wpProQuiz_progress");k.timelimit.show();var s=+new Date;n=window.setInterval(function(){var o=+new Date-s,n=i-o;o>=500&&e.text(u.methode.parseTime(Math.ceil(n/1e3))),t.css("width",n/i*100+"%"),n<=0&&(r.stop(),u.methode.finishQuiz(!0))},16)}}}),L=new function(){var e=[],t=[],o=[],n=[],r=0,a=0,d=0,c=0,p=0,l=[];function h(i){var e="",t=l[i];t.review?e="#FFB800":t.solved&&(e="#6CA54C"),n.eq(i).css("background-color",e)}function f(i){i.preventDefault();var e=i.pageY-a;e<0&&(e=0),e>r&&(e=r);var n=d*e;o.attr("style","margin-top: "+-n+"px !important"),t.css({top:e})}function w(e){e.preventDefault(),i(document).unbind(".scrollEvent")}this.init=function(){e=s.find(".wpProQuiz_reviewQuestion"),t=e.find("div"),o=e.find("ol"),n=o.children(),t.mousedown(function(e){e.preventDefault(),e.stopPropagation(),a=e.pageY-t.offset().top+c,i(document).bind("mouseup.scrollEvent",w),i(document).bind("mousemove.scrollEvent",f)}),n.click(function(e){u.methode.showQuestion(i(this).index())}),s.bind("questionSolved",function(i){l[i.values.index].solved=i.values.solved,h(i.values.index)}),s.bind("changeQuestion",function(i){n.removeClass("wpProQuiz_reviewQuestionTarget"),n.eq(i.values.index).addClass("wpProQuiz_reviewQuestionTarget"),function(i){var r=n.eq(i),s=r.offset().top,a=e.offset().top,u=s-a;if(u-4<0||u+32>100){var c=a-n.eq(0).offset().top-(a-o.offset().top)+r.position().top;c>p&&(c=p);var l=c/d;o.attr("style","margin-top: "+-c+"px !important"),t.css({top:l})}}(i.values.index)}),s.bind("reviewQuestion",function(i){l[i.values.index].review=!l[i.values.index].review,h(i.values.index)}),e.bind("mousewheel DOMMouseScroll",function(i){i.preventDefault();var e=i.originalEvent,n=20*(e.wheelDelta?-e.wheelDelta/120:e.detail/3),r=c-o.offset().top+n;r>p&&(r=p),r<0&&(r=0);var s=r/d;return o.attr("style","margin-top: "+-r+"px !important"),t.css({top:s}),!1})},this.show=function(i){if(Q.reviewQustion&&e.parent().show(),s.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").show(),!i){o.attr("style","margin-top: 0px !important"),t.css({top:0});var n=o.outerHeight(),u=e.height();r=u-t.height(),a=0,d=(p=n-u)/r,this.reset(),n>100&&t.show(),c=t.offset().top}},this.hide=function(){e.parent().hide()},this.toggle=function(){if(Q.reviewQustion){e.parent().toggle(),n.removeClass("wpProQuiz_reviewQuestionTarget"),s.find(".wpProQuiz_reviewDiv .wpProQuiz_button2").hide(),o.attr("style","margin-top: 0px !important"),t.css({top:0});var i=o.outerHeight(),u=e.height();r=u-t.height(),a=0,d=(p=i-u)/r,i>100&&t.show(),c=t.offset().top}},this.reset=function(){for(var i=0,e=n.length;i<e;i++)l[i]={};n.removeClass("wpProQuiz_reviewQuestionTarget").css("background-color","")}};var A=new function(){var i=0,e=-1,t=0,o=!1;this.questionStart=function(t){-1!=e&&this.questionStop(),e=t,i=+new Date},this.questionStop=function(){-1!=e&&(d[e].time+=Math.round((new Date-i)/1e3),e=-1)},this.startQuiz=function(){o&&this.stopQuiz(),t=+new Date,o=!0},this.stopQuiz=function(){o&&(d.comp.quizTime+=Math.round((new Date-t)/1e3),o=!1)},this.init=function(){}},T=new function(){var e=function(e){return!(e=i.trim(e))||0===e.length},t=0,o=1,n=2,r=3,a=4,u=5,d=6,c=7,p=8;this.checkForm=function(){var l=!0;return s.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var s=i(this),h=1==s.data("required"),f=s.data("type"),w=!0,m=i.trim(s.val());switch(f){case t:case o:case c:h&&(w=!e(m));break;case n:!h&&e(m)||(w=!e(m)&&!isNaN(m));break;case a:!h&&e(m)||(w=!e(m)&&new RegExp(/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/).test(m));break;case r:h&&(w=s.is(":checked"));break;case u:case p:h&&(w=void 0!==s.find('input[type="radio"]:checked').val());break;case d:var Q=0,z=0;s.find("select").each(function(){Q++,z+=e(i(this).val())?0:1}),(h||z>0)&&(w=Q==z)}w?s.siblings(".wpProQuiz_invalidate").hide():(l=!1,s.siblings(".wpProQuiz_invalidate").show())}),l},this.getFormData=function(){var e={};return s.find(".wpProQuiz_forms input, .wpProQuiz_forms textarea, .wpProQuiz_forms .wpProQuiz_formFields, .wpProQuiz_forms select").each(function(){var s=i(this),l=s.data("form_id");switch(s.data("type")){case t:case o:case c:case n:case a:e[l]=s.val();break;case r:e[l]=s.is(":checked")?1:0;break;case u:case p:e[l]=s.find('input[type="radio"]:checked').val();break;case d:e[l]={day:s.find('select[name="wpProQuiz_field_'+l+'_day"]').val(),month:s.find('select[name="wpProQuiz_field_'+l+'_month"]').val(),year:s.find('select[name="wpProQuiz_field_'+l+'_year"]').val()}}}),e}};u.methode={parseBitOptions:function(){if(a.bo){Q.randomAnswer=1&a.bo,Q.randomQuestion=2&a.bo,Q.disabledAnswerMark=4&a.bo,Q.checkBeforeStart=8&a.bo,Q.preview=16&a.bo,Q.isAddAutomatic=64&a.bo,Q.reviewQustion=128&a.bo,Q.quizSummeryHide=256&a.bo,Q.skipButton=512&a.bo,Q.autoStart=1024&a.bo,Q.forcingQuestionSolve=2048&a.bo,Q.hideQuestionPositionOverview=4096&a.bo,Q.formActivated=8192&a.bo,Q.maxShowQuestion=16384&a.bo,Q.sortCategories=32768&a.bo;var i=32&a.bo;i&&null!=jQuery.support&&null!=jQuery.support.cors&&0==jQuery.support.cors&&(Q.cors=i)}},setClozeStyle:function(){s.find(".wpProQuiz_cloze input").each(function(){for(var e=i(this),t="",o=e.data("wordlen"),n=0;n<o;n++)t+="w";var r=i(document.createElement("span")).css("visibility","hidden").text(t).appendTo(i("body")),s=r.width();r.remove(),e.width(s+5)})},parseTime:function(i){var e=parseInt(i%60),t=parseInt(i/60%60),o=parseInt(i/3600%24);return(o=(o>9?"":"0")+o)+":"+(t=(t>9?"":"0")+t)+":"+(e=(e>9?"":"0")+e)},cleanupCurlyQuotes:function(e){return e=(e=(e=(e=e.replace(/\u2018/,"'")).replace(/\u2019/,"'")).replace(/\u201C/,'"')).replace(/\u201D/,'"'),i.trim(e).toLowerCase()},resetMatrix:function(e){e.each(function(){var e=i(this),t=e.find(".wpProQuiz_sortStringList");e.find(".wpProQuiz_sortStringItem").each(function(){t.append(i(this))})})},marker:function(i,e){Q.disabledAnswerMark||(e?i.addClass("wpProQuiz_answerCorrect"):i.addClass("wpProQuiz_answerIncorrect"))},startQuiz:function(e){if(z.loadLock)z.isQuizStart=1;else{if(z.isQuizStart=0,z.isLocked)return k.quizStartPage.hide(),void s.find(".wpProQuiz_lock").show();if(z.isPrerequisite)return k.quizStartPage.hide(),void s.find(".wpProQuiz_prerequisite").show();if(z.isUserStartLocked)return k.quizStartPage.hide(),void s.find(".wpProQuiz_startOnlyRegisteredUser").show();if(Q.maxShowQuestion&&!e)return k.quizStartPage.hide(),s.find(".wpProQuiz_loadQuiz").show(),void u.methode.loadQuizDataAjax(!0);if(!Q.formActivated||a.formPos!=b||T.checkForm()){switch(u.methode.loadQuizData(),Q.randomQuestion&&u.methode.random(k.questionList),Q.randomAnswer&&u.methode.random(s.find(P)),Q.sortCategories&&u.methode.sortCategories(),u.methode.random(s.find(".wpProQuiz_sortStringList")),u.methode.random(s.find('[data-type="sort_answer"]')),s.find(".wpProQuiz_listItem").each(function(e,t){var o=i(this);o.find(".wpProQuiz_question_page span:eq(0)").text(e+1),o.find("> h5 span").text(e+1),o.find(".wpProQuiz_questionListItem").each(function(e,t){i(this).find("> span:not(.wpProQuiz_cloze)").text(e+1+". ")})}),k.next=s.find(_),a.mode){case 3:s.find('input[name="checkSingle"]').show();break;case 2:s.find(v).show(),!Q.skipButton&&Q.reviewQustion&&s.find(g).show();break;case 1:s.find('input[name="back"]').slice(1).show();case 0:k.next.show()}(Q.hideQuestionPositionOverview||3==a.mode)&&s.find(".wpProQuiz_question_page").hide();var o=k.next.last();f=o.val(),o.val(a.lbn);var n=k.questionList.children();if(k.listItems=s.find(".wpProQuiz_list > li"),3==a.mode)u.methode.showSinglePage(0);else{var r=(l=n.eq(0).show()).find(P).data("question_id");A.questionStart(r)}A.startQuiz(),s.find(".wpProQuiz_sortable").parents("ul").sortable({update:function(e,t){var o=i(this).parents(".wpProQuiz_listItem");s.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}}).disableSelection(),s.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable({connectWith:".wpProQuiz_maxtrixSortCriterion:not(:has(li)), .wpProQuiz_sortStringList",placeholder:"wpProQuiz_placehold",update:function(e,t){var o=i(this).parents(".wpProQuiz_listItem");s.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:!0}})}}).disableSelection(),h=[],I.start(),p=+new Date,d={comp:{points:0,correctQuestions:0,quizTime:0}},s.find(".wpProQuiz_questionList").each(function(){var e=i(this).data("question_id");d[e]={time:0,solved:0}}),c={},i.each(t.catPoints,function(i,e){c[i]=0}),k.quizStartPage.hide(),s.find(".wpProQuiz_loadQuiz").hide(),k.quiz.show(),L.show(),3!=a.mode&&s.trigger({type:"changeQuestion",values:{item:l,index:l.index()}})}}},showSingleQuestion:function(i){var e=i?Math.ceil(i/a.qpp):1;this.showSinglePage(e)},showSinglePage:function(i){if($listItem=k.questionList.children().hide(),a.qpp){i=i?+i:1;var e=Math.ceil(s.find(".wpProQuiz_list > li").length/a.qpp);if(!(i>e)){var t=s.find(q).hide(),o=s.find(x).hide(),n=s.find('input[name="checkSingle"]').hide();i>1&&t.val(t.data("text").replace(/%d/,i-1)).show(),i==e?n.show():o.val(o.data("text").replace(/%d/,i+1)).show(),m=i;var r=a.qpp*(i-1);$listItem.slice(r,r+a.qpp).show(),u.methode.scrollTo(k.quiz)}}else $listItem.show()},nextQuestion:function(){this.showQuestionObject(l.next())},prevQuestion:function(){this.showQuestionObject(l.prev())},showQuestion:function(i){var e=k.listItems.eq(i);if(3==a.mode||w)return a.qpp&&u.methode.showSingleQuestion(i+1),u.methode.scrollTo(e,1),void A.startQuiz();this.showQuestionObject(e)},showQuestionObject:function(i){if(!i.length&&Q.forcingQuestionSolve&&Q.quizSummeryHide&&Q.reviewQustion)for(var e=0,t=s.find(".wpProQuiz_listItem").length;e<t;e++)if(!h[e])return alert(WpProQuizGlobal.questionsNotSolved),!1;if(l.hide(),l=i.show(),u.methode.scrollTo(k.quiz),s.trigger({type:"changeQuestion",values:{item:l,index:l.index()}}),l.length){var o=l.find(P).data("question_id");A.questionStart(o)}else u.methode.showQuizSummary()},skipQuestion:function(){s.trigger({type:"skipQuestion",values:{item:l,index:l.index()}}),u.methode.nextQuestion()},reviewQuestion:function(){s.trigger({type:"reviewQuestion",values:{item:l,index:l.index()}})},showQuizSummary:function(){if(A.questionStop(),A.stopQuiz(),!Q.quizSummeryHide&&Q.reviewQustion){var e=s.find(".wpProQuiz_checkPage");e.find("ol:eq(0)").empty().append(s.find(".wpProQuiz_reviewQuestion ol li").clone().removeClass("wpProQuiz_reviewQuestionTarget")).children().click(function(t){e.hide(),k.quiz.show(),L.show(!0),u.methode.showQuestion(i(this).index())});for(var t=0,o=0,n=h.length;o<n;o++)h[o]&&t++;e.find("span:eq(0)").text(t),L.hide(),k.quiz.hide(),e.show(),u.methode.scrollTo(e)}else Q.formActivated&&a.formPos==y?(L.hide(),k.quiz.hide(),u.methode.scrollTo(s.find(".wpProQuiz_infopage").show())):u.methode.finishQuiz()},finishQuiz:function(e){A.questionStop(),A.stopQuiz(),I.stop();var t=(+new Date-p)/1e3;t=a.timelimit&&t>a.timelimit?a.timelimit:t,s.find(".wpProQuiz_quiz_time span").text(u.methode.parseTime(t)),e&&k.results.find(".wpProQuiz_time_limit_expired").show(),u.methode.checkQuestion(k.questionList.children(),!0),s.find(".wpProQuiz_correct_answer").text(d.comp.correctQuestions),d.comp.result=Math.round(d.comp.points/a.globalPoints*100*100)/100,d.comp.solved=0;var o=s.find(".wpProQuiz_points span");o.eq(0).text(d.comp.points),o.eq(1).text(a.globalPoints),o.eq(2).text(d.comp.result+"%");var n=s.find(".wpProQuiz_resultsList > li").eq(u.methode.findResultIndex(d.comp.result)),r=T.getFormData();n.find(".wpProQuiz_resultForm").each(function(){var e=i(this),t=e.data("form_id"),o=r[t];"object"==typeof o&&(o=o.day+"-"+o.month+"-"+o.year),e.text(o).show()}),n.show(),u.methode.setAverageResult(d.comp.result,!1),this.setCategoryOverview(),u.methode.sendCompletedQuiz(),Q.isAddAutomatic&&S.isUser&&u.methode.addToplist(),L.hide(),s.find(".wpProQuiz_checkPage, .wpProQuiz_infopage").hide(),k.quiz.hide(),k.results.show(),u.methode.scrollTo(k.results)},setCategoryOverview:function(){d.comp.cats={},s.find(".wpProQuiz_catOverview li").each(function(){var e=i(this),t=e.data("category_id");if(void 0===a.catPoints[t])return e.hide(),!0;var o=Math.round(c[t]/a.catPoints[t]*100*100)/100;d.comp.cats[t]=o,e.find(".wpProQuiz_catPercent").text(o+"%"),e.show()})},questionSolved:function(i){h[i.values.index]=i.values.solved;var e=i.values.item.find(P),t=a.json[e.data("question_id")];d[t.id].solved=Number(i.values.fake?d[t.id].solved:i.values.solved)},sendCompletedQuiz:function(){if(!Q.preview){var e;e=d,s.find(".wpProQuiz_questionList").each(function(){var t=i(this),o=t.data("question_id"),n=t.data("type"),r={};if("single"==n||"multiple"==n)t.find(".wpProQuiz_questionListItem").each(function(){r[i(this).data("pos")]=+i(this).find(".wpProQuiz_questionInput").is(":checked")});else if("free_answer"==n)r[0]=t.find(".wpProQuiz_questionInput").val();else{if("sort_answer"==n)return!0;if("matrix_sort_answer"==n)return!0;if("cloze_answer"==n){var s=0;t.find(".wpProQuiz_cloze input").each(function(){r[s++]=i(this).val()})}else"assessment_answer"==n&&(r[0]="",t.find(".wpProQuiz_questionInput:checked").each(function(){r[i(this).data("index")]=i(this).val()}))}e[o].data=r});var t=T.getFormData();u.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"completedQuiz",data:{quizId:a.quizId,results:d,forms:t}})}},findResultIndex:function(i){for(var e=a.resultsGrade,t=-1,o=999999,n=0;n<e.length;n++){var r=e[n];i>=r&&i-r<o&&(o=i-r,t=n)}return t},showQustionList:function(){w=!w,k.toplistShowInButton.hide(),k.quiz.toggle(),s.find(".wpProQuiz_QuestionButton").hide(),k.questionList.children().show(),L.toggle(),s.find(".wpProQuiz_question_page").hide()},random:function(e){e.each(function(){var e=i(this).children().get().sort(function(){return Math.round(Math.random())-.5});i(e).appendTo(e[0].parentNode)})},sortCategories:function(){var e=i(".wpProQuiz_list").children().get().sort(function(e,t){var o=i(e).find(".wpProQuiz_questionList").data("question_id"),n=i(t).find(".wpProQuiz_questionList").data("question_id");return a.json[o].catId-a.json[n].catId});i(e).appendTo(e[0].parentNode)},restartQuiz:function(){k.results.hide(),k.quizStartPage.show(),k.questionList.children().hide(),k.toplistShowInButton.hide(),L.hide(),s.find(".wpProQuiz_questionInput, .wpProQuiz_cloze input").removeAttr("disabled").removeAttr("checked").css("background-color",""),s.find('.wpProQuiz_questionListItem input[type="text"]').val(""),s.find(".wpProQuiz_answerCorrect, .wpProQuiz_answerIncorrect").removeClass("wpProQuiz_answerCorrect wpProQuiz_answerIncorrect"),s.find(".wpProQuiz_listItem").data("check",!1),s.find(".wpProQuiz_response").hide().children().hide(),u.methode.resetMatrix(s.find(".wpProQuiz_listItem")),s.find(".wpProQuiz_sortStringItem, .wpProQuiz_sortable").removeAttr("style"),s.find(".wpProQuiz_clozeCorrect, .wpProQuiz_QuestionButton, .wpProQuiz_resultsList > li").hide(),s.find('.wpProQuiz_question_page, input[name="tip"]').show(),s.find(".wpProQuiz_resultForm").text("").hide(),k.results.find(".wpProQuiz_time_limit_expired").hide(),k.next.last().val(f),w=!1},checkQuestion:function(e,t){(e=null==e?l:e).each(function(){var e=i(this),o=e.find(P),n=a.json[o.data("question_id")],r=n.type;if(A.questionStop(),e.data("check"))return!0;"single"!=n.type&&"multiple"!=n.type||(r="singleMulti");var p,l,h,f,w,m,z,q,x=(p=r,l=n,h=e,f=o,w=!0,m=0,z=i.isArray(l.points),q={},{singleMulti:function(){var e=f.find(".wpProQuiz_questionInput").attr("disabled","disabled"),t=l.diffMode;f.children().each(function(o){var n=i(this),r=n.data("pos"),s=e.eq(o).is(":checked");l.correct[r]?(s?z&&(t?m=l.points[r]:m+=l.points[r]):w=!1,l.disCorrect?w=!0:u.methode.marker(n,!0)):s?(l.disCorrect?w=!0:(u.methode.marker(n,!1),w=!1),t&&(m=l.points[r])):z&&!t&&(m+=l.points[r])})},sort_answer:function(){var e=f.children();e.each(function(e,t){var o=i(this);q[e]=o.data("pos"),e==o.data("pos")?(u.methode.marker(o,!0),z&&(m+=l.points[e])):(u.methode.marker(o,!1),w=!1)}),e.children().css({"box-shadow":"0 0",cursor:"auto"}),f.sortable("destroy"),e.sort(function(e,t){return i(e).data("pos")>i(t).data("pos")?1:-1}),f.append(e)},matrix_sort_answer:function(){var e=f.children(),t=new Array;q={0:-1},e.each(function(){var e=i(this),o=e.data("pos"),n=e.find(".wpProQuiz_maxtrixSortCriterion"),r=n.children();r.length&&(q[o]=r.data("pos")),r.length&&i.inArray(String(o),String(r.data("correct")).split(","))>=0?(u.methode.marker(n,!0),z&&(m+=l.points[o])):(w=!1,u.methode.marker(n,!1)),t[o]=n}),u.methode.resetMatrix(h),h.find(".wpProQuiz_sortStringItem").each(function(){var e=t[i(this).data("pos")];null!=e&&e.append(this)}).css({"box-shadow":"0 0",cursor:"auto"}),h.find(".wpProQuiz_sortStringList, .wpProQuiz_maxtrixSortCriterion").sortable("destroy")},free_answer:function(){var e=f.children(),t=e.find(".wpProQuiz_questionInput").attr("disabled","disabled").val();i.inArray(i.trim(t).toLowerCase(),l.correct)>=0?u.methode.marker(e,!0):(u.methode.marker(e,!1),w=!1)},cloze_answer:function(){f.find(".wpProQuiz_cloze").each(function(e,t){var o=i(this).children(),n=o.eq(0),r=o.eq(1),s=u.methode.cleanupCurlyQuotes(n.val());i.inArray(s,l.correct[e])>=0?(z&&(m+=l.points[e]),Q.disabledAnswerMark||n.css("background-color","#B0DAB0")):(Q.disabledAnswerMark||n.css("background-color","#FFBABA"),w=!1,r.show()),n.attr("disabled","disabled")})},assessment_answer:function(){w=!0;var e=f.find(".wpProQuiz_questionInput").attr("disabled","disabled"),t=0;e.filter(":checked").each(function(){t+=parseInt(i(this).val())}),m=t}}[p](),!z&&w&&(m=l.points),{c:w,p:m,s:q});e.find(".wpProQuiz_response").show(),e.find(v).hide(),e.find(g).hide(),e.find(_).show(),d[n.id].points=x.p,d[n.id].correct=Number(x.c),d[n.id].data=x.s,d.comp.points+=x.p,c[n.catId]+=x.p,x.c?(e.find(".wpProQuiz_correct").show(),d.comp.correctQuestions+=1):e.find(".wpProQuiz_incorrect").show(),e.find(".wpProQuiz_responsePoints").text(x.p),e.data("check",!0),t||s.trigger({type:"questionSolved",values:{item:e,index:e.index(),solved:!0,fake:!0}})})},showTip:function(){var e=i(this),t=e.siblings(".wpProQuiz_question").find(P).data("question_id");e.siblings(".wpProQuiz_tipp").toggle("fast"),d[t].tip=1,i(document).bind("mouseup.tipEvent",function(e){var t=s.find(".wpProQuiz_tipp"),o=s.find('input[name="tip"]');t.is(e.target)||0!=t.has(e.target).length||o.is(e.target)||(t.hide("fast"),i(document).unbind(".tipEvent"))})},ajax:function(e,t,o){o=o||"json",Q.cors&&(jQuery.support.cors=!0),i.post(WpProQuizGlobal.ajaxurl,e,t,o),Q.cors&&(jQuery.support.cors=!1)},checkQuizLock:function(){z.loadLock=1,u.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizCheckLock",data:{quizId:a.quizId}},function(i){null!=i.lock&&(z.isLocked=i.lock.is,i.lock.pre&&s.find('input[name="restartQuiz"]').hide()),null!=i.prerequisite&&(z.isPrerequisite=1,s.find(".wpProQuiz_prerequisite span").text(i.prerequisite)),null!=i.startUserLock&&(z.isUserStartLocked=i.startUserLock),z.loadLock=0,z.isQuizStart&&u.methode.startQuiz()})},loadQuizData:function(){u.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"loadQuizData",data:{quizId:a.quizId}},function(i){i.toplist&&u.methode.handleToplistData(i.toplist),null!=i.averageResult&&u.methode.setAverageResult(i.averageResult,!0)})},setAverageResult:function(i,e){var t=s.find(".wpProQuiz_resultValue:eq("+(e?0:1)+") > * ");t.eq(1).text(i+"%"),t.eq(0).css("width",240*i/100+"px")},handleToplistData:function(i){var e=s.find(".wpProQuiz_addToplist"),t=e.find(".wpProQuiz_addBox").show().children("div");if(i.canAdd)if(e.show(),e.find(".wpProQuiz_addToplistMessage").hide(),e.find(".wpProQuiz_toplistButton").show(),S.token=i.token,S.isUser=0,i.userId)t.hide(),S.isUser=1,Q.isAddAutomatic&&e.hide();else{t.show();var o=t.children().eq(1);i.captcha?(o.find('input[name="wpProQuiz_captchaPrefix"]').val(i.captcha.code),o.find(".wpProQuiz_captchaImg").attr("src",i.captcha.img),o.find('input[name="wpProQuiz_captcha"]').val(""),o.show()):o.hide()}else e.hide()},scrollTo:function(e,t){var o=e.offset().top-100;(t||(window.pageYOffset||document.body.scrollTop)>o)&&i("html,body").animate({scrollTop:o},300)},addToplist:function(){if(!Q.preview){var i=s.find(".wpProQuiz_addToplistMessage").text(WpProQuizGlobal.loadData).show(),e=s.find(".wpProQuiz_addBox").hide();u.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"addInToplist",data:{quizId:a.quizId,token:S.token,name:e.find('input[name="wpProQuiz_toplistName"]').val(),email:e.find('input[name="wpProQuiz_toplistEmail"]').val(),captcha:e.find('input[name="wpProQuiz_captcha"]').val(),prefix:e.find('input[name="wpProQuiz_captchaPrefix"]').val(),points:d.comp.points,totalPoints:a.globalPoints}},function(t){i.text(t.text),t.clear?(e.hide(),u.methode.updateToplist()):e.show(),t.captcha&&(e.find(".wpProQuiz_captchaImg").attr("src",t.captcha.img),e.find('input[name="wpProQuiz_captchaPrefix"]').val(t.captcha.code),e.find('input[name="wpProQuiz_captcha"]').val(""))})}},updateToplist:function(){"function"==typeof wpProQuiz_fetchToplist&&wpProQuiz_fetchToplist()},registerSolved:function(){s.find('.wpProQuiz_questionInput[type="text"]').change(function(e){var t=i(this),o=t.parents(".wpProQuiz_listItem"),n=!1;""!=t.val()&&(n=!0),s.trigger({type:"questionSolved",values:{item:o,index:o.index(),solved:n}})}),s.find('.wpProQuiz_questionList[data-type="single"] .wpProQuiz_questionInput, .wpProQuiz_questionList[data-type="assessment_answer"] .wpProQuiz_questionInput').change(function(e){var t=i(this).parents(".wpProQuiz_listItem"),o=this.checked;s.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:o}})}),s.find(".wpProQuiz_cloze input").change(function(){var e=i(this).parents(".wpProQuiz_listItem"),t=!0;e.find(".wpProQuiz_cloze input").each(function(){if(""==i(this).val())return t=!1,!1}),s.trigger({type:"questionSolved",values:{item:e,index:e.index(),solved:t}})}),s.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').change(function(e){var t=i(this).parents(".wpProQuiz_listItem"),o=0;t.find('.wpProQuiz_questionList[data-type="multiple"] .wpProQuiz_questionInput').each(function(i){this.checked&&o++}),s.trigger({type:"questionSolved",values:{item:t,index:t.index(),solved:!!o}})})},loadQuizDataAjax:function(e){u.methode.ajax({action:"wp_pro_quiz_admin_ajax",func:"quizLoadData",data:{quizId:a.quizId}},function(t){a.globalPoints=t.globalPoints,a.catPoints=t.catPoints,a.json=t.json,k.quiz.remove(),s.find(".wpProQuiz_quizAnker").after(t.content),k={back:s.find('input[name="back"]'),next:s.find(_),quiz:s.find(".wpProQuiz_quiz"),questionList:s.find(".wpProQuiz_list"),results:s.find(".wpProQuiz_results"),quizStartPage:s.find(".wpProQuiz_text"),timelimit:s.find(".wpProQuiz_time_limit"),toplistShowInButton:s.find(".wpProQuiz_toplistShowInButton"),listItems:i()},u.methode.initQuiz(),e&&u.methode.startQuiz(!0)})},initQuiz:function(){u.methode.setClozeStyle(),u.methode.registerSolved(),k.next.click(function(){if(Q.forcingQuestionSolve&&!h[l.index()]&&(Q.quizSummeryHide||!Q.reviewQustion))return alert(WpProQuizGlobal.questionNotSolved),!1;u.methode.nextQuestion()}),k.back.click(function(){u.methode.prevQuestion()}),s.find(v).click(function(){if(Q.forcingQuestionSolve&&!h[l.index()]&&(Q.quizSummeryHide||!Q.reviewQustion))return alert(WpProQuizGlobal.questionNotSolved),!1;u.methode.checkQuestion()}),s.find('input[name="checkSingle"]').click(function(){if(Q.forcingQuestionSolve&&(Q.quizSummeryHide||!Q.reviewQustion))for(var i=0,e=s.find(".wpProQuiz_listItem").length;i<e;i++)if(!h[i])return alert(WpProQuizGlobal.questionsNotSolved),!1;u.methode.showQuizSummary()}),s.find('input[name="tip"]').click(u.methode.showTip),s.find('input[name="skip"]').click(u.methode.skipQuestion),s.find('input[name="wpProQuiz_pageLeft"]').click(function(){u.methode.showSinglePage(m-1)}),s.find('input[name="wpProQuiz_pageRight"]').click(function(){u.methode.showSinglePage(m+1)})}},u.preInit=function(){u.methode.parseBitOptions(),L.init(),s.find('input[name="startQuiz"]').click(function(){return u.methode.startQuiz(),!1}),Q.preview||u.methode.checkQuizLock(),s.find('input[name="reShowQuestion"]').click(function(){u.methode.showQustionList()}),s.find('input[name="restartQuiz"]').click(function(){u.methode.restartQuiz()}),s.find('input[name="review"]').click(u.methode.reviewQuestion),s.find('input[name="wpProQuiz_toplistAdd"]').click(u.methode.addToplist),s.find('input[name="quizSummary"]').click(u.methode.showQuizSummary),s.find('input[name="endQuizSummary"]').click(function(){if(Q.forcingQuestionSolve)for(var i=0,e=s.find(".wpProQuiz_listItem").length;i<e;i++)if(!h[i])return alert(WpProQuizGlobal.questionsNotSolved),!1;Q.formActivated&&a.formPos==y&&!T.checkForm()||u.methode.finishQuiz()}),s.find('input[name="endInfopage"]').click(function(){T.checkForm()&&u.methode.finishQuiz()}),s.find('input[name="showToplist"]').click(function(){k.quiz.hide(),k.toplistShowInButton.toggle()}),s.bind("questionSolved",u.methode.questionSolved),Q.maxShowQuestion||u.methode.initQuiz(),Q.autoStart&&u.methode.startQuiz()},u.preInit()},i.fn.wpProQuizFront=function(e){return this.each(function(){null==i(this).data("wpProQuizFront")&&i(this).data("wpProQuizFront",new i.wpProQuizFront(this,e))})}}(jQuery);